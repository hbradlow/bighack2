{% extends "site_base.html" %}

{% load i18n %}
{% load ifsetting_tag %}

{% block head_title %}{% trans "Welcome" %}{% endblock %}

{% block body_class %}home{% endblock %}

{% block body %}
	<div id="container" style="width: 100%; height: 400px"></div>
	<div class="row">
		<div class="span4">
			<div id="appliance_list">
				<div>
					Fridge 1
				</div>
			</div>
		</div>
		<div class="span4">
			<input type="text" data-provide="typeahead" id="appliance_input">
		</div>
	</div>
	<script type="text/javascript">
		var chart;
		var appliances =	[
								{% for appliance in appliances %}
									"{{appliance}}",
								{% endfor %}
							]
		var user_data =		[
								{% for datum in user_data %}
								  {{datum}},
								{% endfor %}
							]
		var average_data =	[
								{% for datum in average_data %}
								  {{datum}},
								{% endfor %}
							]
		$(function(){
				$("#appliance_input").keyup(function(event){
						if(event.keyCode=="13"){
							var v = $(this).val();
							var d = "<div>" + v + "</div>";
							$("#appliance_list").append(d);

							appliances.push(v);
							user_data.push(5000);
							average_data.push(5000);
							chart.redraw();

							$(this).val("");
						}
					});
				chart = new Highcharts.Chart({
					chart: {
						renderTo: 'container',
						type: 'bar',
					},
					title: {
						text: 'Energy Usage Summary'
					},
					xAxis: {
						categories: appliances
					},
					yAxis: {
						title: {
							text: 'Energy Used'
						}
					},
					series: [{
						name: 'Your Current Usage',
						  data: user_data 
					}, {
						name: 'Average American Usage',
						  data: average_data 
					}]
				});
		});
	</script>
{% endblock %}
